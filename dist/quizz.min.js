"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var createElement=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement(e);return Object.keys(t).forEach((function(e){return n.setAttribute(e,t[e])})),n},fadeDelay=150,Quizz=function(){function e(t,n){var r=this;_classCallCheck(this,e),_defineProperty(this,"stepsCount",0),_defineProperty(this,"steps",[]),_defineProperty(this,"currentStepNumber",1),_defineProperty(this,"currentStep",null);var s=n.stylePrefix,i=void 0===s?"q":s,a=n.steps,o=n.dataPrefix,c=void 0===o?"q":o;this.root=t,this.stylePrefix=i,this.stepsCount=a.length,this.node=createElement("div",{class:f("container")}),this.form=createElement("form",{action:"/",class:f("form")});var u=createElement("div",{class:f("inner")});this.steps=a.map((function(e,t){return new QuizzStep(e,t+1,f,c,r)})),this.steps.forEach((function(e){return u.append(e.getNode())})),this.steps.length&&(this.currentStep=this.steps[0],this.currentStep.setActive());var p=createElement("footer",{class:f("footer")}),l=createElement("div",{class:f("progress")});this.progressValue=createElement("div",{class:f("progress-value")}),this.progressValue.textContent="0%",this.progressLine=createElement("div",{class:f("progress-line")});var d=createElement("div",{class:f("progress-backline")});l.append(this.progressValue),l.append(this.progressLine),l.append(d);var h=createElement("div",{class:f("controls")});function f(e){return"".concat(i,"-").concat(e)}this.prevButton=createElement("button",{class:f("control-prev"),type:"button",disabled:!0}),this.prevButton.innerHTML='<i class="fa fa-arrow-left" aria-hidden="true"></i>',this.nextButton=createElement("button",{class:f("control-next"),type:"button",disabled:!0}),this.nextButton.innerHTML='Далее <i class="fa fa-arrow-right" aria-hidden="true"></i>',h.append(this.prevButton),h.append(this.nextButton),p.append(l),p.append(h),this.form.append(u),this.form.append(p),this.node.append(this.form)}return _createClass(e,[{key:"changeProgress",value:function(){var e=100*(this.currentStepNumber-1)/(this.stepsCount-1);this.progressValue.textContent=e.toFixed(0)+"%",this.progressValue.style.left=e+"%",this.progressLine.style.width=e+"%"}},{key:"changeCurrentStepNumber",value:function(e){var t=this;(this.currentStep&&this.currentStep.setActive(!1),this.currentStep=this.steps[e-1],this.currentStep)&&(setTimeout((function(){return t.currentStep.setActive()}),fadeDelay),this.setNextButtonDisabled(!this.currentStep.isValid),this.currentStepNumber===this.stepsCount&&this.node.querySelector(".".concat(this.stylePrefix,"-footer")).classList.add("hide"))}},{key:"changeStep",value:function(e){var t=this.currentStepNumber+e;this.prevButton.disabled=t<=1,this.currentStepNumber=t,this.setNextButtonDisabled(!0),this.changeCurrentStepNumber(t),this.changeProgress()}},{key:"setNextButtonDisabled",value:function(e){this.nextButton.disabled=e}},{key:"init",value:function(){var e=this;this.nextButton.addEventListener("click",(function(){return e.changeStep(1)})),this.prevButton.addEventListener("click",(function(){return e.changeStep(-1)})),this.root.append(this.node)}}]),e}();_defineProperty(Quizz,"answerTypes",{text:"text",radio:"radio",checkbox:"checkbox"});var QuizzStep=function(){function e(t,n,r,s,i){var a=this;_classCallCheck(this,e),_defineProperty(this,"answers",[]),_defineProperty(this,"number",void 0),_defineProperty(this,"isValid",!1);var o=t.title,c=t.description,u=t.answers,p=t.html,l=t.name;t.discount,t.manager;if(this.quizz=i,this.number=n,p)return this.node=createElement("div",{class:r("step")}),void(this.node.innerHTML=p);if(this.answers=u.map((function(e,t){return new QuizzAnswer(e,"".concat(s,"-step-").concat(n),t,i.changeStep.bind(i),a.setValid.bind(a),l)})),this.node=createElement("div",{class:r("step")}),o&&this.node.append(this.createTextNode("h3",o,r("step-title"))),c&&this.node.append(this.createTextNode("p",c,r("step-description"))),this.answers.length){var d=createElement("div",{class:r("step-answers q-step-answers-"+n)});this.answers.forEach((function(e){return d.append(e.getNode())})),this.node.append(d)}}return _createClass(e,[{key:"setValid",value:function(e){this.isValid=e,this.quizz.nextButton.disabled=!e}},{key:"setActive",value:function(e){var t=this;if(!1===e)return this.node.classList.add("fadeOut"),this.node.classList.remove("active"),setTimeout((function(){return t.node.classList.remove("fadeOut")}),fadeDelay);this.node.classList.add("fadeIn"),setTimeout((function(){t.node.classList.add("active"),t.node.classList.remove("fadeIn")}),fadeDelay)}},{key:"getNode",value:function(){return this.node}},{key:"createTextNode",value:function(e,t,n){var r=createElement(e,{class:n});return r.textContent=t,r}}]),e}(),QuizzAnswer=function(){function e(t,n,r,s,i,a){_classCallCheck(this,e);var o=t.type,c=void 0===o?"radio":o,u=t.mask;this.node=getAnswerInput(c,"".concat(n,"-input-").concat(r),t,a);var p=this.node.querySelector("input");switch(c){case Quizz.answerTypes.text:this.node.addEventListener("input",(function(e){var t=e.target.value.toLowerCase();if(!u)return i(!!t);var n=t.match(u);if(n)return i(t===n[0]);i(n)}));break;case Quizz.answerTypes.radio:p.addEventListener("click",(function(){i(!0),s(1)}))}t.type,Quizz.answerTypes.radio}return _createClass(e,[{key:"getNode",value:function(){return this.node}}]),e}(),getAnswerInput=function(e,t,n,r){var s=n.value,i=n.placeholder,a=n.checked,o=n.name,c=void 0===o?r:o,u=n.image,p=n.text,l={type:e,name:c,id:t};if(s&&(l.value=s),i&&(l.placeholder=i),a&&(l.checked=a),e===Quizz.answerTypes.text)return createElement("input",_objectSpread(_objectSpread({},l),{},{autocomplete:"off"}));var d=createElement("div");d.append(createElement("input",l));var h=createElement("label",{for:t,name:c});if(u&&h.append(createElement("img",{src:u})),p){var f=createElement("span");f.textContent=p,h.append(f)}return d.append(h),d};